<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>勿忘我 | 爱的表白</title>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=ZCOOL+QingKe+HuangYou&display=swap" rel="stylesheet">
    <style>
        /* 保持原样式不变 */
        /* ...（此处省略原样式代码，与之前一致）... */
        
        /* 新增：图片加载失败提示样式 */
        .image-error {
            position: absolute;
            color: #FFE4E6;
            font-size: 1.2rem;
            text-align: center;
            padding: 20px;
            z-index: 5;
        }
    </style>
</head>
<body>
    <div class="background-flowers"></div>
    <div class="black-transition" id="black-transition"></div>
    
    <div class="container">
        <!-- 第一页保持不变 -->
        <div class="page active" id="page1">
            <h1 class="title" id="title-text">宝宝，亲启</h1>
            <button class="heart-btn" id="start-btn">
                <svg class="heart-icon" viewBox="0 0 24 24">
                    <path d="M12,21.35L10.55,20.03C5.4,15.36 2,12.28 2,8.5C2,5.42 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.09C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.42 22,8.5C22,12.28 18.6,15.36 13.45,20.03L12,21.35Z"/>
                </svg>
            </button>
        </div>
        
        <!-- 第二页：增加图片加载失败提示 -->
        <div class="page" id="page2">
            <div class="image-container">
                <img class="heart-image" id="heart-img1" alt="照片1">
                <div class="image-error" id="error1" style="display: none;">第一张图片加载失败</div>
            </div>
            <div class="text-content" id="text1">
                <div class="typing-container">
                    <span class="typed-text" id="typed-text1"></span>
                </div>
            </div>
        </div>
        
        <!-- 第三页：增加图片加载失败提示 -->
        <div class="page" id="page3">
            <div class="image-container">
                <img class="heart-image" id="heart-img2" alt="照片2">
                <div class="image-error" id="error2" style="display: none;">第二张图片加载失败</div>
            </div>
            <div class="text-content" id="text2">
                <div class="typing-container">
                    <span class="typed-text" id="typed-text2"></span>
                </div>
            </div>
        </div>
        
        <!-- 第四页、第五页保持不变 -->
        <div class="page" id="page4">
            <button class="heart-btn" id="final-heart">
                <svg class="heart-icon" viewBox="0 0 24 24" style="width: 100px; height: 100px;">
                    <path d="M12,21.35L10.55,20.03C5.4,15.36 2,12.28 2,8.5C2,5.42 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.09C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.42 22,8.5C22,12.28 18.6,15.36 13.45,20.03L12,21.35Z"/>
                </svg>
            </button>
        </div>
        
        <div class="page" id="page5">
            <!-- 保持不变 -->
            <canvas id="particles-canvas"></canvas>
            <canvas id="fireworks-canvas"></canvas>
            <div class="page5-content">
                <div class="page5-text-container">
                    <div class="text-content">
                        <div class="typing-container">
                            <p class="typed-text" id="typed-text3"></p>
                        </div>
                        <div class="typing-container" style="margin-top: 15px;">
                            <p class="typed-text" id="typed-text4"></p>
                        </div>
                    </div>
                </div>
                <div class="days-counter" id="time-counter">爱你的第XX天XX时XX分XX秒</div>
            </div>
        </div>
    </div>
    
    <audio id="bg-music" loop>
        <source src="bgm.mp3" type="audio/mp3">
    </audio>
    
    <script>
        // 配置信息 - 重点检查此处的图片文件名是否与实际一致
        const config = {
            title: "宝宝，亲启",
            firstPhoto: "photo1.jpg", // 必须与你的第一张图片文件名完全一致
            secondPhoto: "photo2.jpg", // 必须与你的第二张图片文件名完全一致
            musicFile: "bgm.mp3",
            meetTime: "2023-01-01T00:00",
            text1: "花开一季，有落红为证",
            text2: "逝去的岁月，如何能托于烟尘",
            text3: "这是与你相识的时间",
            text4: "也是爱你的时间"
        };

        // 图片压缩处理函数（优化了错误处理）
        function compressImage(filePath, maxWidth = 600, maxHeight = 600) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.crossOrigin = "anonymous";
                // 图片加载成功
                img.onload = function() {
                    let width = img.width;
                    let height = img.height;
                    
                    // 计算压缩尺寸
                    if (width > height) {
                        if (width > maxWidth) {
                            height = height * (maxWidth / width);
                            width = maxWidth;
                        }
                    } else {
                        if (height > maxHeight) {
                            width = width * (maxHeight / height);
                            height = maxHeight;
                        }
                    }

                    // 压缩并返回base64
                    const canvas = document.createElement('canvas');
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    resolve(canvas.toDataURL('image/jpeg', 0.8));
                };
                // 图片加载失败（关键：增加错误回调）
                img.onerror = function() {
                    reject(new Error(`无法加载图片: ${filePath}`));
                };
                img.src = filePath;
            });
        }

        // 初始化页面元素
        document.getElementById('title-text').textContent = config.title;
        document.getElementById('bg-music').src = config.musicFile;

        // 压缩并加载照片（增加错误提示）
        async function loadCompressedImages() {
            const img1 = document.getElementById('heart-img1');
            const img2 = document.getElementById('heart-img2');
            const error1 = document.getElementById('error1');
            const error2 = document.getElementById('error2');
            
            try {
                // 加载第一张图片
                img1.src = await compressImage(config.firstPhoto);
                img1.onerror = () => { error1.style.display = 'block'; };
            } catch (err) {
                console.error(err);
                error1.style.display = 'block'; // 显示错误提示
            }
            
            try {
                // 加载第二张图片
                img2.src = await compressImage(config.secondPhoto);
                img2.onerror = () => { error2.style.display = 'block'; };
            } catch (err) {
                console.error(err);
                error2.style.display = 'block'; // 显示错误提示
            }
        }

        // 以下代码保持不变（页面逻辑、动画等）
        // ...（此处省略原脚本代码，与之前一致）...

        // 初始化
        loadCompressedImages();
        updateTimeCounter();
    </script>
</body>
</html>